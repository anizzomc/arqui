#include "../../include/defs.h"
#include "../../include/keyboard.h"

struct key_type * key;

char eng_lowercase[256] = { 0, 0x1b, '1', '2', '3', '4', '5', '6', '7', '8',
		'9', '0', '-', '=', '\b', '\t', 'q', 'w', 'e', 'r', 't', 'y', 'u', 'i',
		'o', 'p', '[', ']', '\n', 0, 'a', 's', 'd', 'f', 'g', 'h', 'j', 'k',
		'l', ';', '\'', '\\', 0, '\\', 'z', 'x', 'c', 'v', 'b', 'n', 'm', ',',
		'.', '/', '\\', '.', 56, ' ', 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
		68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,
		'<' };

char eng_uppercase[256] = { 0, 0x1b, '!', '@', '#', '$', '%', '^', '&', '*',
		'(', ')', '_', '+', '\b', '\t', 'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I',
		'O', 'P', '{', '}', '\n', 0, 'A', 'S', 'D', 'F', 'G', 'H', 'J', 'K',
		'L', ':', '"', 0xb3, 0, '|', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', '<',
		'>', '?', '\\', '.', 56, ' ', 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
		68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,
		'>' };

char spa_lowercase[256] = { 0, 0xb3, '1', '2', '3', '4', '5', '6', '7', '8',
		'9', '0', '\'', 0xa8, '\b', '\t', 'q', 'w', 'e', 'r', 't', 'y', 'u',
		'i', 'o', 'p', '´', '+', '\n', 0, 'a', 's', 'd', 'f', 'g', 'h', 'j',
		'k', 'l', 0xa4, '{', 0xb3, 0, '}', 'z', 'x', 'c', 'v', 'b', 'n', 'm',
		',', '.', '-', '\\', '.', 56, ' ', 58, 59, 60, 61, 62, 63, 64, 65, 66,
		67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
		85, '<' };

char spa_uppercase[256] = { 0, 0xa7, '!', '"', '#', '$', '%', '&', '/', '(',
		')', '=', '?', 0xad, '\b', '\t', 'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I',
		'O', 'P', '¨', '*', '\n', 0, 'A', 'S', 'D', 'F', 'G', 'H', 'J', 'K',
		'L', 0xa5, '[', 0xa7, 42, ']', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', ';',
		':', '_', '\\', '.', 56, ' ', 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
		68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,
		'>' };

struct key_type * parse_scancode(unsigned char c) {

	if (c & 0x80) {
		key->kind = HIDDEN_KEY;
	} else {
		if (printable(c)) {
			key->kind = ALPHANUM_KEY;
			key->ascii = spa_lowercase[c];
		}
	}
	return key;
}

int printable(unsigned char c) {
	if ((c > 1 && c < 29) || (c > 29 && c < 42) || (c > 42 && c < 55) || c == 86
			|| c == 57) {
		return TRUE;
	}
	return FALSE;
}
